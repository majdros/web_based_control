{"ast":null,"code":"var _jsxFileName = \"/home/majd/Desktop/react-ros2-robot/src/components/Latecny.jsx\";\nimport React, { Component } from \"react\";\nimport Alert from \"react-bootstrap/Alert\";\nimport { Row, Col } from \"react-bootstrap\";\nimport Config from \"../scripts/config\";\nclass Latecny extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      latency: null,\n      ros: null\n    };\n  }\n  componentDidMount() {\n    if (this.props.ros) {\n      this.setState({\n        ros: this.props.ros\n      }, () => {\n        this.startLatencyMeasurement();\n      });\n    }\n  }\n  componentDidUpdate(prevProps) {\n    // Aktualisiere die ROS-Verbindung, falls sie sich ändert\n    if (this.props.ros !== prevProps.ros) {\n      this.setState({\n        ros: this.props.ros\n      }, () => {\n        this.startLatencyMeasurement();\n      });\n    }\n  }\n  startLatencyMeasurement() {\n    const {\n      ros\n    } = this.state;\n    if (!ros) {\n      console.warn(\"No ROS connection available for latency measurement.\");\n      return;\n    }\n\n    // Erstelle ein ROS-TOPIC für die Latenz\n    const latency_topic = new window.ROSLIB.Topic({\n      ros: ros,\n      name: Config.LATENCY_TOPIC,\n      // Server muss dieses Topic behandeln\n      messageType: Config.LATENCY_MSG_TYPE\n    });\n\n    // Sende regelmäßig Pings und berechne die Latenz\n    setInterval(() => {\n      const startTime = Date.now(); // Zeitstempel beim Senden\n\n      // Sende eine Nachricht\n      const latency_msg = new window.ROSLIB.Message({\n        data: \"ping\"\n      });\n      latency_topic.publish(latency_msg);\n\n      // Warte auf die Antwort\n      latency_topic.subscribe(response => {\n        const endTime = Date.now(); // Zeitstempel beim Empfang\n        const latency = endTime - startTime; // Latenz berechnen\n        this.setState({\n          latency\n        }); // Latenz im State speichern\n        latency_topic.unsubscribe(); // Nur einmal auf die Antwort warten\n      });\n    }, CON); // Alle 5 Sekunden messen\n  }\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Row, {\n      className: \"mb-5\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"h3\", {\n      className: \"mt-4\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 25\n      }\n    }, \"Latecny\"), /*#__PURE__*/React.createElement(\"p\", {\n      className: \"mt-0\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 72,\n        columnNumber: 25\n      }\n    }, this.state.latency !== null ? this.state.latency + \"ms\" : \"Measurement in progress...\"))));\n  }\n}\nexport default Latecny;","map":{"version":3,"names":["React","Component","Alert","Row","Col","Config","Latecny","constructor","args","state","latency","ros","componentDidMount","props","setState","startLatencyMeasurement","componentDidUpdate","prevProps","console","warn","latency_topic","window","ROSLIB","Topic","name","LATENCY_TOPIC","messageType","LATENCY_MSG_TYPE","setInterval","startTime","Date","now","latency_msg","Message","data","publish","subscribe","response","endTime","unsubscribe","CON","render","createElement","__self","__source","fileName","_jsxFileName","lineNumber","columnNumber","className"],"sources":["/home/majd/Desktop/react-ros2-robot/src/components/Latecny.jsx"],"sourcesContent":["import React, { Component} from \"react\";\nimport Alert from \"react-bootstrap/Alert\";\nimport { Row, Col} from \"react-bootstrap\";\nimport Config from \"../scripts/config\"\n\nclass Latecny extends Component{\n    state = {\n        latency: null,\n        ros: null,\n    };\n\n    componentDidMount() {\n        if (this.props.ros) {\n            this.setState({ ros: this.props.ros }, () => {\n                this.startLatencyMeasurement();\n            });\n        }\n    }\n\n\n    componentDidUpdate(prevProps) {\n        // Aktualisiere die ROS-Verbindung, falls sie sich ändert\n        if (this.props.ros !== prevProps.ros) {\n            this.setState({ ros: this.props.ros }, () => {\n                this.startLatencyMeasurement();\n            });\n        }\n    }\n\n    startLatencyMeasurement() {\n        const { ros } = this.state;\n\n        if (!ros) {\n            console.warn(\"No ROS connection available for latency measurement.\");\n            return;\n        }\n\n        // Erstelle ein ROS-TOPIC für die Latenz\n        const latency_topic = new window.ROSLIB.Topic({\n            ros: ros,\n            name: Config.LATENCY_TOPIC, // Server muss dieses Topic behandeln\n            messageType: Config.LATENCY_MSG_TYPE,\n        });\n\n        // Sende regelmäßig Pings und berechne die Latenz\n        setInterval(() => {\n            const startTime = Date.now(); // Zeitstempel beim Senden\n\n            // Sende eine Nachricht\n            const latency_msg = new window.ROSLIB.Message({\n                data: \"ping\",\n            });\n            latency_topic.publish(latency_msg);\n\n            // Warte auf die Antwort\n            latency_topic.subscribe((response) => {\n                const endTime = Date.now(); // Zeitstempel beim Empfang\n                const latency = endTime - startTime; // Latenz berechnen\n                this.setState({ latency }); // Latenz im State speichern\n                latency_topic.unsubscribe(); // Nur einmal auf die Antwort warten\n            });\n        }, CON); // Alle 5 Sekunden messen\n    }\n\n\n    render(){\n        return(\n            <div>\n                <Row className=\"mb-5\">\n                    <Col >\n                        <h3 className=\"mt-4\">Latecny</h3>\n                        <p className=\"mt-0\">\n                            {this.state.latency !== null?  this.state.latency + \"ms\" : \"Measurement in progress...\"}\n                        </p>\n                    </Col>\n                </Row>\n            </div>\n        );\n    }\n}\n\nexport default Latecny;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}